{
  "hash": "0568403dcc52319d8b0992258454a87c",
  "result": {
    "markdown": "---\ntitle: \"Introducing the PLACES Package\"\nauthor: \"Brenden Smith\"\ndate: \"2023-12-17\"\ncategories: [R, Packages, API, vignette]\ndescription: \"\"\nengine: knitr\nexecute: \n  warning: false\n  eval: true\n# image: \ncode-fold: show\ncode-overflow: scroll\ntoc: true\n---\n\n\n## Introduction\nThis post contains a brief vignette demonstrating the use of the package `PLACES`.\n\nTo begin, we can install `PLACES` from github, then load our packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"brendensm/PLACES\")\n\nlibrary(PLACES)\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n:::\n\n\n## Function: `get_measures`\nOur first functions allows us to easily view what measures we can query, along with a brief definition. If we run `get_measures`, we must specify a release year. Then we can view the measures in a data frame in the R Studio viewer. If we instead print `measures23`, the pre-loaded data set, we see a preview.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(measures23) %>% tibble()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n  year  measureid short_question_text           measure       categoryid release\n  <chr> <chr>     <chr>                         <chr>         <chr>      <chr>  \n1 2021  OBESITY   Obesity                       Obesity amon… HLTHOUT    2023   \n2 2021  STROKE    Stroke                        Stroke among… HLTHOUT    2023   \n3 2021  ARTHRITIS Arthritis                     Arthritis am… HLTHOUT    2023   \n4 2020  SLEEP     Sleep <7 hours                Sleeping les… RISKBEH    2023   \n5 2021  INDEPLIVE Independent Living Disability Independent … DISABLT    2023   \n6 2021  COGNITION Cognitive Disability          Cognitive di… DISABLT    2023   \n```\n:::\n:::\n\n\nRemember to use the `measureid` when using the next function.\n\n## Function: `get_places`\nThis function allows us to easily query data that we specify. In the example below, I will get the measure `ACCESS2` (the current lack of health insurance among adults aged 18-64 years) for the state of Arizona. This function allows for multiple of these arguments.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naz_access <- get_places(state = \"AZ\", measure = \"ACCESS2\") \nhead(az_access)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 21\n  year  stateabbr statedesc locationname datasource category   measure          \n  <chr> <chr>     <chr>     <chr>        <chr>      <chr>      <chr>            \n1 2021  AZ        Arizona   Yuma         BRFSS      Prevention Current lack of …\n2 2021  AZ        Arizona   Graham       BRFSS      Prevention Current lack of …\n3 2021  AZ        Arizona   Apache       BRFSS      Prevention Current lack of …\n4 2021  AZ        Arizona   La Paz       BRFSS      Prevention Current lack of …\n5 2021  AZ        Arizona   Coconino     BRFSS      Prevention Current lack of …\n6 2021  AZ        Arizona   Cochise      BRFSS      Prevention Current lack of …\n# ℹ 14 more variables: data_value_unit <chr>, data_value_type <chr>,\n#   data_value <dbl>, low_confidence_limit <dbl>, high_confidence_limit <dbl>,\n#   totalpopulation <chr>, locationid <chr>, categoryid <chr>, measureid <chr>,\n#   datavaluetypeid <chr>, short_question_text <chr>, type <chr>, lon <dbl>,\n#   lat <dbl>\n```\n:::\n:::\n\n\nIt is also worth noting that by default `geo` specifying geography is set to `county`. If instead we want to examine census tracts, we could specify the argument. Likewise, release is set to `2023`.\n\n## Use Case\n\nFrom here, we can start to have fun. It is fairly straight forward to begin exploring data. Here I will first filter out the data so that I can plot the age adjusted rates of lack of health insurance in Arizona.\n\nNotice that the data provide you with confidence limits, so I have chosen to plot them here with error bars.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naz_access %>%\n  filter(datavaluetypeid == \"AgeAdjPrv\") %>%\n  ggplot(aes(data_value, reorder(locationname, data_value))) +\n  geom_point(size = 2) +\n  geom_errorbar(aes(xmin = low_confidence_limit, xmax = high_confidence_limit)) +\n  labs(title = \"Lack of health insurance among adults aged 18-64 years In Arizona Counties\",\n       y = \"\", x = \"Percent\") +\n  theme_minimal() +\n  theme(plot.title.position = \"plot\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nYou can also extend this to multiple states to compare. You can easily query two (or more) state names, and plot them. Arizona seems to have a couple of counties that have a much higher rate compared to others.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# multi state comparison\ntwo <- get_places(state = c(\"AZ\", \"NV\"), measure = \"ACCESS2\")\n\ntwo %>%\n  filter(datavaluetypeid == \"AgeAdjPrv\") %>%\n  ggplot(aes(data_value, reorder(locationname, data_value), color = stateabbr)) +\n  geom_point(size = 2) +\n  geom_errorbar(aes(xmin = low_confidence_limit, xmax = high_confidence_limit)) +\n  labs(title = \n         \"Lack of health insurance among adults aged 18-64 years In Arizona and Nevada\",\n       y = \"Counties\", x = \"Percent\") +\n  theme_minimal() +\n  theme(plot.title.position = \"plot\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nWe can go even further by comparing more states in the region. Here I have taken the average rate by state to easily compare. Texas appears to be far above the average.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmulti <- get_places(state = c(\"AZ\", \"NV\", \"NM\", \"TX\", \"CA\"), measure = \"ACCESS2\") %>%\n  filter(datavaluetypeid == \"AgeAdjPrv\") %>%\n  summarise(.by = \"stateabbr\", mean_val = mean(data_value), mean_low = mean(low_confidence_limit), mean_high = mean(high_confidence_limit))\n\nmulti %>%\n  ggplot(aes(mean_val, reorder(stateabbr, mean_val), color = stateabbr)) +\n  geom_point(size = 2) +\n  geom_errorbar(aes(xmin = mean_low, xmax = mean_high)) +\n  labs(title = \"Mean lack of health insurance among adults aged 18-64 years In Southwest States\",\n       y = \"\", x = \"Percent\") +\n  theme_minimal() +\n  theme(plot.title.position = \"plot\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}